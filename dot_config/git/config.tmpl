# git config
[alias]
    s                    = "status"
    lg                   = "log --graph --abbrev-commit --decorate --format=format:'%C(bold blue)%h%C(reset) - %C(bold green)(%ar)%C(reset) %C(white)%s%C(reset) %C(dim white)- %an%C(reset)%C(bold yellow)%d%C(reset)' --all"
    push-current         = "!sh -c 'git push -u origin $(git rev-parse --abbrev-ref HEAD)'"
    force-push-current   = "!sh -c 'git push -u --force-with-lease origin $(git rev-parse --abbrev-ref HEAD)'"
    stash-list           = "stash list --pretty=format:'%Cblue%gd%Cred: %C(yellow)%s'"
    prev                 = "checkout HEAD^1"
    next                 = "!sh -c 'target=$(git rev-parse --verify master 2>/dev/null && echo master || echo main); git log --reverse --pretty=%H $target | awk \"/$(git rev-parse HEAD)/{getline;print}\" | xargs git checkout'"
    find-merge           = "!sh -c 'commit=$0 && branch=${1:-HEAD} && (git rev-list $commit..$branch --ancestry-path | cat -n; git rev-list $commit..$branch --first-parent | cat -n) | sort -k2 -s | uniq -f1 -d | sort -n | tail -1 | cut -f2'"
    show-merge           = "!sh -c 'merge=$(git find-merge $0 $1) && [ -n \"$merge\" ] && git show $merge'"
    dm                   = "!git branch --merged | grep -vE '^\\*|main|master' | xargs -n 1 git branch -d"

    # only for macos
    copy-branch-name     = "!sh -c 'echo `git rev-parse --abbrev-ref HEAD` | pbcopy' > /dev/null || return && exit 0"

    proxy-clean          = !git config --global http.proxy '' && git config --global https.proxy ''
    proxy-enable         = !git config --global http.proxy '{{ .http_proxy }}' && git config --global https.proxy '{{ .https_proxy }}'
    proxy-socks5-enable  = !git config --global http.proxy '{{ .socks5_proxy }}' && git config --global https.proxy '{{ .socks5_proxy }}'

[core]
    editor = "nvim"
    quotepath = false
    longpaths = true
    autocrlf = input
    trustctime = false
    attributesfile = ~/.attributes_global
    ignorecase = true
    untrackedcache = true
    excludesfile = ~/.config/git/ignore
    pager = delta

[init]
    defaultBranch = main

[fetch]
    prune = true

[column]
    ui = auto

[rerere]
    enabled = true
    autoupdate = true

[interactive]
    diffFilter = delta --color-only

[diff]
    tool = nvimdiff
[difftool]
    prompt = false
[difftool "nvimdiff"]
    cmd = nvim -d "$LOCAL" "$REMOTE"

[delta]
    navigate = true
    dark = true
    syntax-theme = Nord
    features = nord
    line-numbers = true
    side-by-side = true

    [delta "nord"]
    syntax-theme = Nord
    minus-style = syntax "#3f2d3d"
    minus-emph-style = syntax "#763e46"
    plus-style = syntax "#283b38"
    plus-emph-style = syntax "#38544d"
    file-style = "bold #81a1c1"
    file-decoration-style = "#81a1c1 box"
    hunk-header-style = file line-number syntax
    hunk-header-decoration-style = "#81a1c1 box"
    line-numbers-zero-style = "#4c566a"
    line-numbers-left-style = "#4c566a"
    line-numbers-right-style = "#4c566a"
    line-numbers-minus-style = "#bf616a"
    line-numbers-plus-style = "#a3be8c"

[merge]
    conflictStyle = zdiff3

[i18n]
    commitencoding = utf-8

[gui]
    encoding = utf-8

[pull]
    rebase = true

[user]
    name = {{ .user }}
    email = {{ .email }}
    signingkey = {{ .signingkey }}

[http]
    proxy = {{ .http_proxy }}
    postBuffer = 524288000

[https]
    proxy = {{ .https_proxy }}

[branch "master"]
    pushRemote = no_push
[branch "main"]
    pushRemote = no_push

[commit]
    gpgSign = true

[gpg]
    program = {{ .gpgcommand }}

[tag]
    gpgSign = true

[url "git@github.com:"]
    insteadOf = https://github.com/
    defaultBranch = main

[diff "text"]
    textconv = cat

[filter "lfs"]
    clean = git-lfs clean -- %f
    smudge = git-lfs smudge -- %f
    process = git-lfs filter-process
    required = true

[mergetool]
    keepBackup = false

[lfs]
    concurrenttransfers = 8
    fetchrecentrefsdays = 0
    pruneoffsetdays = 0
    dialtimeout = 3
    tlstimeout = 3

[lfs "transfer"]
    maxretries = 1
    maxretrydelay = 2

[merge "lfs-text"]
    driver = git lfs merge-driver --ancestor %O --current %A --other %B --marker-size %L --output %A --program 'git merge-file --stdout --marker-size=%%L %%A %%O %%B >%%D'

[rebase]
    backend = merge

[push]
    autoSetupRemote = true
